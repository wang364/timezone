import xml.etree.ElementTree as ET
import os

# 定义各种语言的翻译映射
translations = {
    "zh": {
        "时区工具设置": "时区工具设置",
        "时间格式:": "时间格式:",
        "24小时制": "24小时制",
        "12小时制": "12小时制",
        "日期格式:": "日期格式:",
        "YYYY-MM-DD": "YYYY-MM-DD",
        "MM/DD/YYYY": "MM/DD/YYYY",
        "DD/MM/YYYY": "DD/MM/YYYY",
        "星期格式:": "星期格式:",
        "Mon": "Mon",
        "Monday": "Monday",
        "语言:": "语言:",
        "中文": "中文",
        "English": "English",
        "日本語": "日本語",
        "한국어": "한국어",
        "Français": "Français",
        "Deutsch": "Deutsch",
        "Español": "Español",
        "Português": "Português",
        "开机自启动": "开机自启动",
        "显示秒数": "显示秒数",
        "显示日期": "显示日期",
        "显示星期": "显示星期",
        "常规设置": "常规设置",
        "城市管理": "城市管理",
        "保存": "保存",
        "取消": "取消",
        "添加城市:": "添加城市:",
        "输入城市名称搜索，回车或从下拉列表选择添加...": "输入城市名称搜索，回车或从下拉列表选择添加...",
        "已添加的城市:": "已添加的城市:",
        "删除": "删除",
        "上移": "上移",
        "下移": "下移",
        "时区工具": "时区工具",
        "设置": "设置",
        "显示时区窗口": "显示时区窗口",
        "退出": "退出",
        "隐藏时区窗口": "隐藏时区窗口",
        "当前时间: %1\n时区工具": "当前时间: %1\n时区工具",
        "时区显示": "时区显示",
        "暂无城市，请在设置中添加": "暂无城市，请在设置中添加",
        "警告": "警告",
        "请输入城市名称": "请输入城市名称",
        "确认删除": "确认删除",
        "确定要删除城市 '%1' 吗？": "确定要删除城市 '%1' 吗？",
        "城市 '%1' 未找到或不在可用列表中": "城市 '%1' 未找到或不在可用列表中"
    },
    "en": {
        "时区工具设置": "Timezone Tool Settings",
        "时间格式:": "Time Format:",
        "24小时制": "24-hour format",
        "12小时制": "12-hour format",
        "日期格式:": "Date Format:",
        "YYYY-MM-DD": "YYYY-MM-DD",
        "MM/DD/YYYY": "MM/DD/YYYY",
        "DD/MM/YYYY": "DD/MM/YYYY",
        "星期格式:": "Weekday Format:",
        "Mon": "Mon",
        "Monday": "Monday",
        "语言:": "Language:",
        "中文": "Chinese",
        "English": "English",
        "日本語": "Japanese",
        "한국어": "Korean",
        "Français": "French",
        "Deutsch": "German",
        "Español": "Spanish",
        "Português": "Portuguese",
        "开机自启动": "Start with system",
        "显示秒数": "Show seconds",
        "显示日期": "Show date",
        "显示星期": "Show weekday",
        "常规设置": "General Settings",
        "城市管理": "City Management",
        "保存": "Save",
        "取消": "Cancel",
        "添加城市:": "Add City:",
        "输入城市名称搜索，回车或从下拉列表选择添加...": "Enter city name to search, press Enter or select from dropdown to add...",
        "已添加的城市:": "Added Cities:",
        "删除": "Delete",
        "上移": "Move Up",
        "下移": "Move Down",
        "时区工具": "Timezone Tool",
        "设置": "Settings",
        "显示时区窗口": "Show Timezone Window",
        "退出": "Exit",
        "隐藏时区窗口": "Hide Timezone Window",
        "当前时间: %1\n时区工具": "Current Time: %1\nTimezone Tool",
        "时区显示": "Timezone Display",
        "暂无城市，请在设置中添加": "No cities yet, please add in settings",
        "警告": "Warning",
        "请输入城市名称": "Please enter city name",
        "确认删除": "Confirm Deletion",
        "确定要删除城市 '%1' 吗？": "Are you sure you want to delete city '%1'?",
        "城市 '%1' 未找到或不在可用列表中": "City '%1' not found or not in available list"
    },
    "ja": {
        "时区工具设置": "タイムゾーンツールの設定",
        "时间格式:": "時間形式:",
        "24小时制": "24時間表示",
        "12小时制": "12時間表示",
        "日期格式:": "日付形式:",
        "YYYY-MM-DD": "YYYY-MM-DD",
        "MM/DD/YYYY": "MM/DD/YYYY",
        "DD/MM/YYYY": "DD/MM/YYYY",
        "星期格式:": "曜日形式:",
        "Mon": "月",
        "Monday": "月曜日",
        "语言:": "言語:",
        "中文": "中国語",
        "English": "英語",
        "日本語": "日本語",
        "한국어": "韓国語",
        "Français": "フランス語",
        "Deutsch": "ドイツ語",
        "Español": "スペイン語",
        "Português": "ポルトガル語",
        "开机自启动": "システム起動時に開始",
        "显示秒数": "秒を表示",
        "显示日期": "日付を表示",
        "显示星期": "曜日を表示",
        "常规设置": "一般設定",
        "城市管理": "都市管理",
        "保存": "保存",
        "取消": "キャンセル",
        "添加城市:": "都市を追加:",
        "输入城市名称搜索，回车或从下拉列表选择添加...": "都市名を入力して検索し、Enterキーを押すかドロップダウンから選択して追加...",
        "已添加的城市:": "追加された都市:",
        "删除": "削除",
        "上移": "上に移動",
        "下移": "下に移動",
        "时区工具": "タイムゾーンツール",
        "设置": "設定",
        "显示时区窗口": "タイムゾーンウィンドウを表示",
        "退出": "終了",
        "隐藏时区窗口": "タイムゾーンウィンドウを隠す",
        "当前时间: %1\n时区工具": "現在の時間: %1\nタイムゾーンツール",
        "时区显示": "タイムゾーン表示",
        "暂无城市，请在设置中添加": "都市がありません。設定で追加してください",
        "警告": "警告",
        "请输入城市名称": "都市名を入力してください",
        "确认删除": "削除の確認",
        "确定要删除城市 '%1' 吗？": "都市 '%1' を削除してもよろしいですか？",
        "城市 '%1' 未找到或不在可用列表中": "都市 '%1' が見つからないか、利用可能なリストに含まれていません"
    },
    "ko": {
        "时区工具设置": "타임존 도구 설정",
        "时间格式:": "시간 형식:",
        "24小时制": "24시간 형식",
        "12小时制": "12시간 형식",
        "日期格式:": "날짜 형식:",
        "YYYY-MM-DD": "YYYY-MM-DD",
        "MM/DD/YYYY": "MM/DD/YYYY",
        "DD/MM/YYYY": "DD/MM/YYYY",
        "星期格式:": "요일 형식:",
        "Mon": "월",
        "Monday": "월요일",
        "语言:": "언어:",
        "中文": "중국어",
        "English": "영어",
        "日本語": "일본어",
        "한국어": "한국어",
        "Français": "프랑스어",
        "Deutsch": "독일어",
        "Español": "스페인어",
        "Português": "포르투갈어",
        "开机自启动": "시스템 시작 시 실행",
        "显示秒数": "초 표시",
        "显示日期": "날짜 표시",
        "显示星期": "요일 표시",
        "常规设置": "일반 설정",
        "城市管理": "도시 관리",
        "保存": "저장",
        "取消": "취소",
        "添加城市:": "도시 추가:",
        "输入城市名称搜索，回车或从下拉列表选择添加...": "도시 이름을 입력하여 검색하고 Enter 키를 누르거나 드롭다운에서 선택하여 추가...",
        "已添加的城市:": "추가된 도시:",
        "删除": "삭제",
        "上移": "위로 이동",
        "下移": "아래로 이동",
        "时区工具": "타임존 도구",
        "设置": "설정",
        "显示时区窗口": "타임존 창 표시",
        "退出": "종료",
        "隐藏时区窗口": "타임존 창 숨기기",
        "当前时间: %1\n时区工具": "현재 시간: %1\n타임존 도구",
        "时区显示": "타임존 표시",
        "暂无城市，请在设置中添加": "아직 도시가 없습니다. 설정에서 추가하세요",
        "警告": "경고",
        "请输入城市名称": "도시 이름을 입력하세요",
        "确认删除": "삭제 확인",
        "确定要删除城市 '%1' 吗？": "도시 '%1' 을 삭제하시겠습니까？",
        "城市 '%1' 未找到或不在可用列表中": "도시 '%1' 을 찾을 수 없거나 사용 가능한 목록에 없습니다"
    },
    "fr": {
        "时区工具设置": "Paramètres de l'outil de fuseau horaire",
        "时间格式:": "Format de temps:",
        "24小时制": "Format 24h",
        "12小时制": "Format 12h",
        "日期格式:": "Format de date:",
        "YYYY-MM-DD": "YYYY-MM-DD",
        "MM/DD/YYYY": "MM/DD/YYYY",
        "DD/MM/YYYY": "DD/MM/YYYY",
        "星期格式:": "Format du jour:",
        "Mon": "Lun",
        "Monday": "Lundi",
        "语言:": "Langue:",
        "中文": "Chinois",
        "English": "Anglais",
        "日本語": "Japonais",
        "한국어": "Coréen",
        "Français": "Français",
        "Deutsch": "Allemand",
        "Español": "Espagnol",
        "Português": "Portugais",
        "开机自启动": "Démarrer avec le système",
        "显示秒数": "Afficher les secondes",
        "显示日期": "Afficher la date",
        "显示星期": "Afficher le jour",
        "常规设置": "Paramètres généraux",
        "城市管理": "Gestion des villes",
        "保存": "Enregistrer",
        "取消": "Annuler",
        "添加城市:": "Ajouter une ville:",
        "输入城市名称搜索，回车或从下拉列表选择添加...": "Entrez le nom de la ville pour rechercher, appuyez sur Entrée ou sélectionnez dans la liste déroulante pour ajouter...",
        "已添加的城市:": "Villes ajoutées:",
        "删除": "Supprimer",
        "上移": "Déplacer vers le haut",
        "下移": "Déplacer vers le bas",
        "时区工具": "Outil de fuseau horaire",
        "设置": "Paramètres",
        "显示时区窗口": "Afficher la fenêtre de fuseau horaire",
        "退出": "Quitter",
        "隐藏时区窗口": "Cacher la fenêtre de fuseau horaire",
        "当前时间: %1\n时区工具": "Heure actuelle: %1\nOutil de fuseau horaire",
        "时区显示": "Affichage de fuseau horaire",
        "暂无城市，请在设置中添加": "Aucune ville pour le moment, veuillez ajouter dans les paramètres",
        "警告": "Avertissement",
        "请输入城市名称": "Veuillez entrer le nom de la ville",
        "确认删除": "Confirmer la suppression",
        "确定要删除城市 '%1' 吗？": "Êtes-vous sûr de vouloir supprimer la ville '%1' ?",
        "城市 '%1' 未找到或不在可用列表中": "La ville '%1' n'a pas été trouvée ou n'est pas dans la liste disponible"
    },
    "de": {
        "时区工具设置": "Zeitzonen-Tool-Einstellungen",
        "时间格式:": "Zeitformat:",
        "24小时制": "24-Stunden-Format",
        "12小时制": "12-Stunden-Format",
        "日期格式:": "Datumsformat:",
        "YYYY-MM-DD": "YYYY-MM-DD",
        "MM/DD/YYYY": "MM/DD/YYYY",
        "DD/MM/YYYY": "DD/MM/YYYY",
        "星期格式:": "Wochentagsformat:",
        "Mon": "Mo",
        "Monday": "Montag",
        "语言:": "Sprache:",
        "中文": "Chinesisch",
        "English": "Englisch",
        "日本語": "Japanisch",
        "한국어": "Koreanisch",
        "Français": "Französisch",
        "Deutsch": "Deutsch",
        "Español": "Spanisch",
        "Português": "Portugiesisch",
        "开机自启动": "Mit System starten",
        "显示秒数": "Sekunden anzeigen",
        "显示日期": "Datum anzeigen",
        "显示星期": "Wochentag anzeigen",
        "常规设置": "Allgemeine Einstellungen",
        "城市管理": "Stadtverwaltung",
        "保存": "Speichern",
        "取消": "Abbrechen",
        "添加城市:": "Stadt hinzufügen:",
        "输入城市名称搜索，回车或从下拉列表选择添加...": "Geben Sie den Stadtnamen ein, um zu suchen, drücken Sie Enter oder wählen Sie aus der Dropdown-Liste zum Hinzufügen...",
        "已添加的城市:": "Hinzugefügte Städte:",
        "删除": "Löschen",
        "上移": "Nach oben bewegen",
        "下移": "Nach unten bewegen",
        "时区工具": "Zeitzonen-Tool",
        "设置": "Einstellungen",
        "显示时区窗口": "Zeitzonenfenster anzeigen",
        "退出": "Beenden",
        "隐藏时区窗口": "Zeitzonenfenster ausblenden",
        "当前时间: %1\n时区工具": "Aktuelle Zeit: %1\nZeitzonen-Tool",
        "时区显示": "Zeitzonenanzeige",
        "暂无城市，请在设置中添加": "Keine Städte vorhanden, bitte in den Einstellungen hinzufügen",
        "警告": "Warnung",
        "请输入城市名称": "Bitte geben Sie den Stadtnamen ein",
        "确认删除": "Löschbestätigung",
        "确定要删除城市 '%1' 吗？": "Sind Sie sicher, dass Sie die Stadt '%1' löschen möchten?",
        "城市 '%1' 未找到或不在可用列表中": "Stadt '%1' nicht gefunden oder nicht in der verfügbaren Liste"
    },
    "es": {
        "时区工具设置": "Configuración de la herramienta de zona horaria",
        "时间格式:": "Formato de hora:",
        "24小时制": "Formato 24h",
        "12小时制": "Formato 12h",
        "日期格式:": "Formato de fecha:",
        "YYYY-MM-DD": "YYYY-MM-DD",
        "MM/DD/YYYY": "MM/DD/YYYY",
        "DD/MM/YYYY": "DD/MM/YYYY",
        "星期格式:": "Formato de día:",
        "Mon": "Lun",
        "Monday": "Lunes",
        "语言:": "Idioma:",
        "中文": "Chino",
        "English": "Inglés",
        "日本語": "Japonés",
        "한국어": "Coreano",
        "Français": "Francés",
        "Deutsch": "Alemán",
        "Español": "Español",
        "Português": "Portugués",
        "开机自启动": "Iniciar con el sistema",
        "显示秒数": "Mostrar segundos",
        "显示日期": "Mostrar fecha",
        "显示星期": "Mostrar día",
        "常规设置": "Configuración general",
        "城市管理": "Gestión de ciudades",
        "保存": "Guardar",
        "取消": "Cancelar",
        "添加城市:": "Agregar ciudad:",
        "输入城市名称搜索，回车或从下拉列表选择添加...": "Ingrese el nombre de la ciudad para buscar, presione Enter o seleccione de la lista desplegable para agregar...",
        "已添加的城市:": "Ciudades agregadas:",
        "删除": "Eliminar",
        "上移": "Mover arriba",
        "下移": "Mover abajo",
        "时区工具": "Herramienta de zona horaria",
        "设置": "Configuración",
        "显示时区窗口": "Mostrar ventana de zona horaria",
        "退出": "Salir",
        "隐藏时区窗口": "Ocultar ventana de zona horaria",
        "当前时间: %1\n时区工具": "Hora actual: %1\nHerramienta de zona horaria",
        "时区显示": "Visualización de zona horaria",
        "暂无城市，请在设置中添加": "No hay ciudades todavía, por favor agrégue en la configuración",
        "警告": "Advertencia",
        "请输入城市名称": "Por favor, ingrese el nombre de la ciudad",
        "确认删除": "Confirmar eliminación",
        "确定要删除城市 '%1' 吗？": "¿Está seguro de que desea eliminar la ciudad '%1'?",
        "城市 '%1' 未找到或不在可用列表中": "Ciudad '%1' no encontrada o no está en la lista disponible"
    },
    "pt": {
        "时区工具设置": "Configurações da ferramenta de fuso horário",
        "时间格式:": "Formato de hora:",
        "24小时制": "Formato 24h",
        "12小时制": "Formato 12h",
        "日期格式:": "Formato de data:",
        "YYYY-MM-DD": "YYYY-MM-DD",
        "MM/DD/YYYY": "MM/DD/YYYY",
        "DD/MM/YYYY": "DD/MM/YYYY",
        "星期格式:": "Formato do dia:",
        "Mon": "Seg",
        "Monday": "Segunda-feira",
        "语言:": "Idioma:",
        "中文": "Chinês",
        "English": "Inglês",
        "日本語": "Japonês",
        "한국어": "Coreano",
        "Français": "Francês",
        "Deutsch": "Alemão",
        "Español": "Espanhol",
        "Português": "Português",
        "开机自启动": "Iniciar com o sistema",
        "显示秒数": "Mostrar segundos",
        "显示日期": "Mostrar data",
        "显示星期": "Mostrar dia",
        "常规设置": "Configurações gerais",
        "城市管理": "Gerenciamento de cidades",
        "保存": "Salvar",
        "取消": "Cancelar",
        "添加城市:": "Adicionar cidade:",
        "输入城市名称搜索，回车或从下拉列表选择添加...": "Digite o nome da cidade para pesquisar, pressione Enter ou selecione na lista suspensa para adicionar...",
        "已添加的城市:": "Cidades adicionadas:",
        "删除": "Excluir",
        "上移": "Mover para cima",
        "下移": "Mover para baixo",
        "时区工具": "Ferramenta de fuso horário",
        "设置": "Configurações",
        "显示时区窗口": "Mostrar janela de fuso horário",
        "退出": "Sair",
        "隐藏时区窗口": "Ocultar janela de fuso horário",
        "当前时间: %1\n时区工具": "Hora atual: %1\nFerramenta de fuso horário",
        "时区显示": "Exibição de fuso horário",
        "暂无城市，请在设置中添加": "Nenhuma cidade ainda, por favor adicione nas configurações",
        "警告": "Aviso",
        "请输入城市名称": "Por favor, digite o nome da cidade",
        "确认删除": "Confirmar exclusão",
        "确定要删除城市 '%1' 吗？": "Tem certeza que deseja excluir a cidade '%1'?",
        "城市 '%1' 未找到或不在可用列表中": "Cidade '%1' não encontrada ou não está na lista disponível"
    }
}

# 获取所有.ts文件
ts_files = [f for f in os.listdir('.') if f.endswith('.ts')]

for ts_file in ts_files:
    # 获取语言代码（例如：timezone_zh.ts -> zh）
    lang_code = ts_file.split('_')[1].split('.')[0]
    
    if lang_code not in translations:
        print(f"警告: 没有找到语言 {lang_code} 的翻译映射")
        continue
    
    # 解析XML文件
    tree = ET.parse(ts_file)
    root = tree.getroot()
    
    # 遍历所有message标签，更新翻译
    for context in root.findall('context'):
        for message in context.findall('message'):
            source = message.find('source')
            if source is not None and source.text in translations[lang_code]:
                translation = message.find('translation')
                if translation is not None:
                    # 更新翻译内容并移除unfinished标记
                    translation.text = translations[lang_code][source.text]
                    if 'type' in translation.attrib:
                        del translation.attrib['type']
    
    # 保存更新后的文件
    tree.write(ts_file, encoding='utf-8', xml_declaration=True)
    print(f"已更新 {ts_file}")

print("翻译完成!")
